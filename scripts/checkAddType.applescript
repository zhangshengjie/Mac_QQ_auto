use AppleScript version "2.4" -- Yosemite (10.10) or lateruse scripting additionstell application "System Events"	tell application process "QQ"		set addFriendWin to item 1 of every window		set UIelements to get UI elements of addFriendWin		set UInum to count of UIelements		if (UInum > 9) then			set titleUI to item 1 of UIelements			set titleStr to get name of titleUI as Unicode text			if (titleStr = "添加联系人/群聊") then				-- 这是添加好友对话框				-- 最后一个元素为好友验证框框				set sheetUI to item UInum of UIelements				set sheetUIClassName to get class of sheetUI as Unicode text				if (sheetUIClassName = "sheet") then					-- 这是好友验证对话框					set addFriendWinContents to get entire contents of sheetUI					set addFriendWinContentsLen to get count of addFriendWinContents					log addFriendWinContentsLen					set inputLen to -1					if (addFriendWinContentsLen = 4) then						log "不允许任何人"						key code 36						set inputLen to -2					else if (addFriendWinContentsLen = 8) then						log "允许任何人"						set inputLen to 0					else if (addFriendWinContentsLen = 10) then						log "需要验证信息"						set inputLen to 1					else if (addFriendWinContentsLen = 11) then						log "需要回答验证问题 或者 需要回答问题并由我验证 1个问题"						set inputLen to 1					else if (addFriendWinContentsLen = 13) then						log "需要回答问题并由我验证 2个问题"						set inputLen to 2					else if (addFriendWinContentsLen = 15) then						log "需要回答问题并由我验证 3个问题"						set inputLen to 3					else						--log "未知类型"					end if															log "inputlen:" & inputLen					if (inputLen > -1) then						if (inputLen = 0) then							-- 倒数第三个为 button="确定"							set sendBtn to item (addFriendWinContentsLen - 2) of addFriendWinContents						else							-- 倒数第二个为 button="发送"							--log addFriendWinContentsLen							set sendBtn to item (addFriendWinContentsLen - 1) of addFriendWinContents						end if						set positionxy to get the position of the sendBtn						set Xcord to item 1 of positionxy						set Ycord to item 2 of positionxy						set sizec to get the size of the sendBtn						set sizew to item 1 of sizec						set sizeh to item 2 of sizec						log "ps:" & Xcord & "," & Ycord & "," & sizew & "," & sizeh											end if														end if			end if		end if	end tellend tell